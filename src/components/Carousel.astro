---
import { Image } from "astro:assets";
import type { Image as WorkImage } from "@/types/work";

export interface Props {
  images: WorkImage[];
}

const { images } = Astro.props;
const isMultiple = images.length > 1;
---

<swiper-container
  class="relative mx-[calc(50%_-_50vw)] border-y-2 md:border-2 md:mx-0 aspect-video"
  loop="true"
  thumbs-swiper={isMultiple && "#thumbs"}
>
  {
    images.map(({ image, alt }) => (
      <swiper-slide>
        <Image
          src={image.url}
          alt={alt}
          width={image.width}
          height={image.height}
          format="webp"
          loading="eager"
        />
      </swiper-slide>
    ))
  }
</swiper-container>

{
  isMultiple && (
    <swiper-container
      class="mt-4 w-full"
      id="thumbs"
      space-between="8"
      slides-per-view="6"
      watch-slides-progress="true"
    >
      {images.map(({ image, alt }) => (
        <swiper-slide class="border-2 transition-colors cursor-pointer">
          <Image
            src={image.url}
            alt={alt}
            width={image.width * 0.1}
            height={image.height * 0.1}
            format="webp"
            loading="eager"
          />
        </swiper-slide>
      ))}
    </swiper-container>
  )
}

<style>
  #thumbs swiper-slide {
    opacity: 0.5;
  }

  #thumbs swiper-slide:hover {
    border-color: #45a3cc; /* border-sea */
  }

  #thumbs .swiper-slide-thumb-active {
    opacity: 1;
    border-color: #45a3cc; /* border-sea */
  }
</style>

<script>
  import { register } from "swiper/element/bundle";
  register();
</script>
